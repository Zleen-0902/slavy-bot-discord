/*
‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚¢Ä‚°Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä
‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚£¥‚£ø‚£ø‚†Ä‚†Ä‚†Ä‚¢†‚£æ‚£ß‚£§‚°ñ‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä
‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚¢Ä‚£º‚†ã‚†Ä‚†â‚†Ä‚¢Ñ‚£∏‚£ø‚£ø‚£ø‚£ø‚£ø‚£•‚°§‚¢∂‚£ø‚£¶‚£Ä‚°Ä
‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚£ø‚£ø‚°Ü‚†Ä‚†Ä‚†Ä‚£ô‚£õ‚£ø‚£ø‚£ø‚£ø‚°è‚†Ä‚†Ä‚£Ä‚£ø‚£ø‚£ø‚°ü
‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†ô‚†ª‚†∑‚£¶‚£§‚£§‚£¨‚£Ω‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ü‚†õ‚†ø‚†ã‚†Ä
‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚¢Ä‚£¥‚†ã‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚¢ø‚£ø‚£ø‚°Ü‚†Ä‚†Ä
‚†Ä‚†Ä‚†Ä‚†Ä‚£†‚£∂‚£∂‚£∂‚£ø‚£¶‚°Ä‚†ò‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚†ø‚†ã‚†à‚¢π‚°è‚†Å‚†Ä‚†Ä
‚†Ä‚†Ä‚†Ä‚¢Ä‚£ø‚°è‚†â‚†ø‚¢ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£∑‚°Ü‚†Ä‚¢Ä‚£ø‚°á‚†Ä‚†Ä‚†Ä
‚†Ä‚†Ä‚†Ä‚¢∏‚£ø‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†ô‚¢ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ü‚°ò‚£ø‚£ø‚£É‚†Ä‚†Ä‚†Ä
‚£¥‚£∑‚£Ä‚£∏‚£ø‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†ò‚£ø‚£ø‚£ø‚£ø‚†π‚£ø‚£Ø‚£§‚£æ‚†è‚†â‚†â‚†â‚†ô‚†¢‚†Ä
‚†à‚†ô‚¢ø‚£ø‚°ü‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚¢∏‚£ø‚£ø‚£ø‚£Ñ‚†õ‚†â‚¢©‚£∑‚£¥‚°Ü‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä
‚†Ä‚†Ä‚†Ä‚†ã‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†à‚£ø‚£ø‚£ø‚£ø‚£Ä‚°†‚†ã‚†à‚¢ø‚£á‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä
‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†ô‚†ø‚†ø‚†õ‚†Å‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä

--------------------------------------------
üëë Owner    : Enzzyx
üì° Discord  : https://discord.gg/QYVcWZbBp
üõ†Ô∏è Studio   : Hazz Wave Studio
‚úÖ Verified | üß© Flexible | ‚öôÔ∏è Stable
--------------------------------------------
> ¬© 2026 Enzzyx || Hazz Wave Studio || Slavy
--------------------------------------------
*/

const { SlashCommandBuilder, PermissionFlagsBits, EmbedBuilder } = require('discord.js');
const GuildConfig = require('../../models/GuildConfig');

module.exports = {
    data: new SlashCommandBuilder()
        .setName('toggle-antispam')
        .setDescription('üõ°Ô∏è Turn Anti-Spam protection on/off')
        .addBooleanOption(option => 
            option.setName('status')
                .setDescription('Select True for ON, False for OFF')
                .setRequired(true))
        .setDefaultMemberPermissions(PermissionFlagsBits.Administrator),

    async execute(interaction) {
        // Initial defer to prevent interaction timeout
        await interaction.deferReply();
        
        const status = interaction.options.getBoolean('status');

        try {
            // Updating antiSpam status in MongoDB database
            await GuildConfig.findOneAndUpdate(
                { guildId: interaction.guild.id },
                { antiSpam: status },
                { upsert: true }
            );

            const embed = new EmbedBuilder()
                .setTitle('üõ°Ô∏è Auto-Mod System')
                .setColor(status ? '#2ecc71' : '#ff4757')
                .setDescription(`**Anti-Spam** feature is now **${status ? 'ENABLED' : 'DISABLED'}**.`)
                .setFooter({ text: 'Slavy Security System ‚Ä¢ Configuration Updated' })
                .setTimestamp();
                
            await interaction.editReply({ embeds: [embed] });
        } catch (error) {
            console.error(error);
            
            const errorEmbed = new EmbedBuilder()
                .setColor('#ff4757')
                .setDescription('‚ùå Failed to update configuration in the database.');

            await interaction.editReply({ embeds: [errorEmbed] });
        }
    }
};