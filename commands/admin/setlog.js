/*
‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚¢Ä‚°Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä
‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚£¥‚£ø‚£ø‚†Ä‚†Ä‚†Ä‚¢†‚£æ‚£ß‚£§‚°ñ‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä
‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚¢Ä‚£º‚†ã‚†Ä‚†â‚†Ä‚¢Ñ‚£∏‚£ø‚£ø‚£ø‚£ø‚£ø‚£•‚°§‚¢∂‚£ø‚£¶‚£Ä‚°Ä
‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚£ø‚£ø‚°Ü‚†Ä‚†Ä‚†Ä‚£ô‚£õ‚£ø‚£ø‚£ø‚£ø‚°è‚†Ä‚†Ä‚£Ä‚£ø‚£ø‚£ø‚°ü
‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†ô‚†ª‚†∑‚£¶‚£§‚£§‚£¨‚£Ω‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ü‚†õ‚†ø‚†ã‚†Ä
‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚¢Ä‚£¥‚†ã‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚¢ø‚£ø‚£ø‚°Ü‚†Ä‚†Ä
‚†Ä‚†Ä‚†Ä‚†Ä‚£†‚£∂‚£∂‚£∂‚£ø‚£¶‚°Ä‚†ò‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚†ø‚†ã‚†à‚¢π‚°è‚†Å‚†Ä‚†Ä
‚†Ä‚†Ä‚†Ä‚¢Ä‚£ø‚°è‚†â‚†ø‚¢ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£∑‚°Ü‚†Ä‚¢Ä‚£ø‚°á‚†Ä‚†Ä‚†Ä
‚†Ä‚†Ä‚†Ä‚¢∏‚£ø‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†ô‚¢ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ü‚°ò‚£ø‚£ø‚£É‚†Ä‚†Ä‚†Ä
‚£¥‚£∑‚£Ä‚£∏‚£ø‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†ò‚£ø‚£ø‚£ø‚£ø‚†π‚£ø‚£Ø‚£§‚£æ‚†è‚†â‚†â‚†â‚†ô‚†¢‚†Ä
‚†à‚†ô‚¢ø‚£ø‚°ü‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚¢∏‚£ø‚£ø‚£ø‚£Ñ‚†õ‚†â‚¢©‚£∑‚£¥‚°Ü‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä
‚†Ä‚†Ä‚†Ä‚†ã‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†à‚£ø‚£ø‚£ø‚£ø‚£Ä‚°†‚†ã‚†à‚¢ø‚£á‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä
‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†ô‚†ø‚†ø‚†õ‚†Å‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä

--------------------------------------------
üëë Owner    : Enzzyx
üì° Discord  : https://discord.gg/QYVcWZbBp
üõ†Ô∏è Studio   : Hazz Wave Studio
‚úÖ Verified | üß© Flexible | ‚öôÔ∏è Stable
--------------------------------------------
> ¬© 2026 Enzzyx || Hazz Wave Studio || Slavy
--------------------------------------------
*/

const { SlashCommandBuilder, PermissionFlagsBits, ChannelType, EmbedBuilder } = require('discord.js');
const GuildConfig = require('../../models/GuildConfig');

module.exports = {
    data: new SlashCommandBuilder()
        .setName('setlog')
        .setDescription('üì° Set channel log for moderation activity')
        .addChannelOption(option => 
            option.setName('channel')
                .setDescription('Select channel for log report')
                .addChannelTypes(ChannelType.GuildText)
                .setRequired(true))
        .setDefaultMemberPermissions(PermissionFlagsBits.Administrator),

    async execute(interaction) {
        const channel = interaction.options.getChannel('channel');
        await interaction.deferReply();

        try {
            // Update or create a new config in MongoDB
            await GuildConfig.findOneAndUpdate(
                { guildId: interaction.guild.id },
                { logChannelId: channel.id },
                { upsert: true, new: true }
            );

            const successEmbed = new EmbedBuilder()
                .setTitle('üì° Logger System')
                .setColor('#00ffff')
                .setDescription(`Successfully set log channel to ${channel}. Any moderation actions will be reported here.`)
                .setFooter({ text: 'Slavy Security System ‚Ä¢ Configuration Saved' })
                .setTimestamp();
            
            await interaction.editReply({ 
                embeds: [successEmbed] 
            });

        } catch (error) {
            console.error(error);
            
            const errorEmbed = new EmbedBuilder()
                .setColor('#ff4757')
                .setDescription('‚ùå Failed to save log configuration to database.');

            interaction.editReply({ embeds: [errorEmbed] });
        }
    }
};